---
phase: 05-test-&-deploy
plan: 03
type: execute
wave: 3
depends_on: ["05-01", "05-02"]
files_modified:
  - .env.local
autonomous: false

must_haves:
  truths:
    - "Site deployed to production at mokadijital.com"
    - "All pages accessible via HTTPS"
    - "Contact forms submit successfully to n8n webhook"
    - "n8n workflow receives and processes lead data"
    - "Site loads without console errors"
    - "Mobile functionality verified on production"
  artifacts:
    - path: ".env.local"
      provides: "Production environment configuration"
      contains: "NEXT_PUBLIC_N8N_WEBHOOK_URL, NEXT_PUBLIC_BASE_URL"
  key_links:
    - from: "Production site"
      to: "n8n webhook"
      via: "POST request on form submit"
      pattern: "webhook.*n8n"
---

<objective>
Deploy static site to production PHP hosting and verify all functionality including forms, navigation, and n8n webhook integration.

Purpose: Complete production deployment and validate end-to-end functionality. Output includes live site at production domain with working contact forms and n8n integration.
</objective>

<execution_context>
@C:\Users\Omer\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\Omer\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@DEPLOYMENT.md
@.env.production.example

# Phase 3 Summary (n8n webhook)
@.planning/phases/03-form-entegrasyonu-&-n8n-webhook/03-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <what-built>Deployment documentation and build artifacts ready from Plan 01</what-built>
  <how-to-verify>
    User completes deployment steps (Claude cannot automate cPanel/SFTP access):

    1. **Configure production environment**:
       - Copy .env.production.example to .env.local
       - Update NEXT_PUBLIC_N8N_WEBHOOK_URL with production URL from n8n
       - Update NEXT_PUBLIC_BASE_URL=https://mokadijital.com

    2. **Build production assets**:
       - Run: npm run build
       - Verify out/ folder generated successfully

    3. **Upload to hosting** (choose one method):
       - cPanel File Manager: Zip out/ folder, upload, extract to public_html
       - FTP/SFTP: Upload entire out/ folder contents to public_html
       - FileZilla: Drag out/ contents to server

    4. **Verify deployment**:
       - Visit https://mokadijital.com
       - Check homepage loads
       - Test navigation to service pages

    Reference DEPLOYMENT.md for detailed instructions.
  </how-to-verify>
  <resume-signal>Type "deployed" when site is live at production URL, or describe deployment issues</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Verify .env.local production configuration</name>
  <files>.env.local</files>
  <action>
    Verify .env.local is configured for production:

    1. Read .env.local file
    2. Check NEXT_PUBLIC_BASE_URL=https://mokadijital.com
    3. Check NEXT_PUBLIC_N8N_WEBHOOK_URL points to production webhook (not webhook-test)
    4. Verify URL format: https://ai.mokadijital.com/webhook/{actual-webhook-id}

    If .env.local has test/placeholder URLs:
    - Remind user to update with production values from n8n
    - Explain webhook URL is available after activating workflow in n8n UI

    Do NOT modify .env.local values. User must configure based on their n8n instance.
  </action>
  <verify>.env.local exists with production BASE_URL and webhook URL (user-configured values)</verify>
  <done>Production environment configuration verified for deployment</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Site deployed to production hosting, environment configured</what-built>
  <how-to-verify>
    After site is deployed, verify production functionality:

    1. **Homepage verification**:
       - Visit https://mokadijital.com
       - Check logo loads
       - Verify all sections visible (Hero, Service Cards, About)
       - Check footer information

    2. **Service pages** (test 2-3):
       - Navigate to /hizmetler/google-isletme-optimizasyonu
       - Navigate to /hizmetler/pmk
       - Verify page content displays correctly
       - Check contact modal opens

    3. **Form submission test**:
       - Open contact modal on any page
       - Fill form: Name, Email, Phone, Company, Message
       - Click submit button
       - Verify success message appears
       - Check n8n workflow execution log (https://ai.mokadijital.com)

    4. **Browser console check**:
       - Open DevTools (F12)
       - Check Console tab for errors
       - Check Network tab for failed requests

    Expected: All pages load, forms submit successfully, n8n receives lead data.
  </how-to-verify>
  <resume-signal>Type "verified" if all checks pass, or describe issues (e.g., "Form returns 404", "n8n not receiving data")</resume-signal>
</task>

</tasks>

<verification>
Overall phase checks:
1. Site deployed and accessible at https://mokadijital.com
2. All 7 pages (homepage + 6 services) load without errors
3. Contact forms open and submit successfully
4. n8n webhook receives form submissions
5. No console errors on any page
6. Responsive design works on production (mobile verification)
</verification>

<success_criteria>
- Site live at production domain with all pages accessible
- Contact forms successfully submit to n8n webhook
- n8n workflow processes lead data
- No critical errors in browser console
- User can complete end-to-end flow: visit site -> open form -> submit -> lead captured
</success_criteria>

<output>
After completion, create `.planning/phases/05-test-&-deploy/05-03-SUMMARY.md`
</output>
